<div class="row m-page-heading">
  <div class="col-xs-12">
    <h3><% if ( model.isNew() ) { %>New Theme<% } else { %><%=model.get( 'title' ) %><% } %></h3>
    <% if ( !model.isNew() ) { %>
    <p class="text-muted">
      Status:
      <% if(model.hasStatus('ready')) { %>
      <span class="text-success"><i class="icon-ok"></i>Ready</span>
      <% } else if(model.hasStatus('broken')) { %>
      <span class="text-danger"><i class="icon-alert"></i>Broken</span>
      <% } else if(model.hasStatus('updating')) { %>
      <span class="text-warning"><%=render(require('./spinner.ejs'), {size:10, color:'#FFA039'})%>Upgrading</span>
      <% } else { %>
      <span class="text-warning"><i class="icon-info"></i><%=capitalize(model.get('status')) %></span>
      <% } %>
    </p>
    <% } %>
  </div>
</div>

<div class="row">
  <div class="col-xs-12">
    <div id="edit">
      <div class="row">
        <div class="col-sm-12">
          <form id="new-theme" role="form"
                data-next="show" data-model="Theme"
                <% if(model.isNew()) { %>
                data-action="new"
                <% } else { %>
                data-action="edit" data-model-id="<%=model.get('id') %>"
                <% } %> >
            <div class="form-group">
              <label for="title">Title</label>
              <input type="text" required class="form-control"
                     <% if(!model.isNew()) { %>value="<%=model.get('title') %>"<% } %>
                     id="title" name="title" placeholder="Enter title">
            </div>
            <% if (model.isNew()) { %>
            <div class="form-group">
              <label for="group_id" class="block">Group</label>
              <div class="select">
                <select id="group_id" name="group_id" class="form-control">
                  <option>Select group</option>
                  <% this.app.designerGroups.each(function(group) { %>
                      <option value="<%= group.get('id') %>" <% if ( model.get('group_id') === group.get('id') ) { %>selected<% } %>>
                        <%= group.get('name') %>
                      </option>
                  <% }); %>
                </select>
              </div>
            </div>
            <% } %>
            <div class="form-group">
              <label for="data">Theme data</label>
              <div id="data" style="height:300px;"></div>
            </div>
            <button type="submit" class="btn btn-primary"
                    data-loading-text="Saving...">Save changes</button>

            <% if ( !model.isNew() && !model.isDefault()) { %>
            <button type="button" class="btn btn-danger"
                    data-action-message="Theme deleted"
                    data-action-confirm="Are you sure you wish to delete this?"
                    data-loading-text="Deleting..."
                    data-action="destroy"
                    data-action-next="/themes" data-model="Theme"
                    data-model-id="<%=model.get('slug') %>">Delete</button>
            <% } %>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
